#### 0x0C-开始行动

#### 写在最前方

- 对于线程的概念以及意义，我说一些
	- 现在我只说一个多线程的技术对于C语言程序而言就像，原本只有你一个人在干活，现在突然有许多人愿意追随你，变成了以你为核心的多人合作模式，共同完成**同一个任务**。
	- 导致的结果就是，这个任务被切分成多个模块，有可能很多人一起做同一个模块，有可能某些模块只有一个人在做，这就带来了什么问题呢？
	- "我" 对这个任务的掌控力度变低了，试想本来就是我一个人在开发这个程序，程序的每部分都是我一个字符一个字符敲上去的，自然了解程序的每个部分。但是现在，突然多了一些人来和你一起完成这个任务，必然导致有一部分程序代码不是由你亲自写下去的，虽然你指示他们怎么做，做出什么样的功能。
	- 但是毕竟不是你亲自写的，所以他们在协调工作的时候，很大可能性会出现问题，这个问题在多线程变成里面就是**资源争夺**问题，也就是同一个**内存块**， 在同一时刻被多于一个的线程访问，那么该如何处理呢？
	- C语言到现在已经支持多线程(然而零零散散的，虽然C11标准支持多线程库)了，并没有办法实际用在编程里，我一般使用 各平台的 **API** 或者 **Glib** 进行多线程编程，前者是不需要配置环境直接上手，缺点就是无法跨平台(万恶的**Windows**)。后者则是需要配置环境，且这个库说实话的确很臃肿，对于我们即将写的这个备份程序有些杀鸡用牛刀。

- 在这里我不会说什么线程的概念，这是计算机科学家该干的事情。
- 一直不解那些概念是用来干嘛的，理解万岁。
- 看完上面的解释，就准备开始着手写程序了

#### 写在中间

- 首先我使用的是 **Visual Studio 2013**作为编译器
- 创建 **Win32控制台应用程序**
- 记得创建**C源文件**
- 如果不小心点成**C++**也没事，改成**.c**就行。

1. 创建一个入口源文件`Entery.c`，用于放置`main`函数

			#include <stdio.h>
			#include <stdlib.h>

			int main(int argc, char* argv[])
			{
				system("pause"); /* 因为Windows的命令行命令对大小写不敏感，所以命令无所谓大小写,从环境变量的配置就能知道这一点 */
				return 0;
			}
		因为等一下需要构造一个字符显示界面模拟GUI的功能，故添加`#include <stdlib.h>`

		当然并不是只因为这个原因。但是现在是为了使用其中的`system()`函数调用系统命令。

- 好，那么接下来...
- 等一下，要直接写程序了吗？程序功能呢？程序结构呢？从哪里开始写呢？
	- 这些都没有考虑啊！！

- 所以，停下来我们好好构思构思！
	- 问题：
		1. 我们要做什么？ ： 一个多线程的备份程序
		2. 我们要怎么做？ ： 这个问题有点大，应该拆开
		3. 我们从哪里开始做？ ： 这个问题比较好回答。
	- 回答：
		1. 略
		2. 我们要实现把某个路径备份到某个特定路径
			- 首先要实现路径的设置，也就是说由键盘输入路径
			- 得到了路径之后，要得到该路径下**所有文件夹和文件**的**信息**(在*nix下这俩玩意儿都是一个东西)
			- 行了就这么简单
		3. 先从输出所有文件和文件夹的结构开始

	- 问题：
		1. 怎么得到文件和文件夹的信息？

	- 回答：
		1. MSDN放在网上，虽然现在不提供离线版本了，但是也没有被墙啊。所以不懂的时候就一个字，查**API**文档！对于十分基本的**API**， MSDN甚至会给出示例代码。恰好，这就是一个。

- **题外话**
	- 其实会写这个程序没什么大不了，重要的是学习能力，一个自我学习的能力，就比如当我不知道一个东西，也无从下手的情况下，我应该进行联想，联想可能与他相关的各种方面，并且亲自去查，不厌其烦的查，遍地撒网，重点捞鱼。

- 首先我们需要实现一个功能，就是遍历输出路径下的所有文件夹和文件
- 在这之前，我们先设计一下界面，稍后`3, 2, 1`，出现！

		while(1)
		{
			system("cls"); /* 系统的清屏命令 */
			do{
				puts("-------------------------------------------------\n");
				puts("-------------------------------------------------\n");
				puts("That is a System Back Up Software for Windows! \n");
				puts("List of the software function : \n");
				puts("1. Back Up \n");
				puts("2. Set Back Up TO PATH \n");
				puts("3. Read Me \n");
				puts("4. Exit \n");
				puts("-------------------------------------------------\n");

				puts("Your Select: ");
				fscanf(stdin, "%d", &select);
				getchar(); /* 读取上方 fscanf 留在流里面的换行符 '\n' */
				}while ((select < 1) || (select > 4)); /* 如果选择无效 */
				system("cls");

				switch(select)
				{
				case 1 :
					break;
				case 2 :
					break;
				case 3 :
					break;
				case 4 :
					exit(0); /* 退出程序 */
				default :
					break;
				}/** switch(select) **/
			}/** while(1) **/
			system("pause");
			return 0;
	突然出现的这一段代码就是设计的界面，其实很简单，看看就懂了，不再多说。

	英文莫怪。

- 紧接着，我们来实现第一个功能，显示结构，让我们吧这个功能函数叫做`show_structure`
	- 新建头文件`showFiles.h`

			/*头文件包裹一定要切记*/
			#ifndef INCLUDE_SHOWFILES_H
			#define INCLUDE_SHOWFILES_H
			/* 代码写在里面，这样就不会发生重定义，也能节省资源 */
			#endif
	- 新建源文件`showFiles.c`
			- 记得包含头文件`#include <showFiles.h>`

	- `showFiles.h`
			
			#include <stdio.h>
			#inlcude <stdlib.h>
			#include <windows.h> /* Windows API */
			#inculde <string.h>  /* 字符串函数 */
			#include <tchar.h>	 /* _ftprintf */
			#include <setjmp.h>  /* setjmp, longjmp */
			
			/* 我们需要在这里面包含函数的声明 */
			/** 加上文档注释，不太喜欢死板的硬套，选择自己觉得重要的信息记录吧
			 * @version 1.0 2015/09/28
			 * @author  wushengxin
			 * @function 用于输出显示目录结构的，可以改变输出流
			*/
			void show_structure(const char * from_dir_name， int depth);
	题外话，在**Visual Studio**中，会强制要求你使用他们编写的安全函数,例如`fscanf_s`，如果你不想用的话，那就将它关闭吧，具体怎么操作，就当是一个小问题留给你自己。

	- `showFiles.c`

			/* 首先是需要的一系列变量 */
			int times = 0; /* 用来配合 setjmp和longjmp重新获取句柄HANDLE的 */
		

